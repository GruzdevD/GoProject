# Kafka to API Service

Этот проект представляет собой Go-сервис, который читает сообщения из Kafka-топика и отправляет их на указанный API-эндпоинт. Он разработан для простоты и эффективности, используя возможности конкурентности Go для обработки сообщений и выполнения API-запросов.

---

## Структура проекта

```
kafka-to-api-service
├── cmd
│   └── main.go          # Точка входа в приложение
├── internal
│   ├── kafka
│   │   └── consumer.go  # Реализация Kafka-консьюмера
│   ├── api
│   │   └── client.go    # API-клиент для отправки сообщений
│   └── config
│       └── config.go    # Загрузка конфигурации
├── pkg
│   └── logger
│       └── logger.go     # Реализация логгера
├── go.mod                # Файл модулей Go
├── go.sum                # Контрольные суммы модулей Go
└── README.md             # Документация проекта
```

---

## Установка

Для установки необходимых зависимостей выполните:

```bash
go mod tidy
```

---

## Конфигурация

Приложение требует файл конфигурации для указания параметров подключения к Kafka и API-эндпоинта. Конфигурация загружается с помощью функции `LoadConfig`, определенной в `internal/config/config.go`.

Пример файла конфигурации (`internal/config/config.json`):

```json
{
    "brokers": ["localhost:9092"],
    "group_id": "my-group",
    "topic": "test-topic",
    "min_bytes": 10000,
    "max_bytes": 10000000,
    "message_limit": 10,
    "post_url": "http://localhost:8080/api/messages",
    "port": 8080
}
```

- **`brokers`**: Список брокеров Kafka.
- **`group_id`**: Группа консьюмера.
- **`topic`**: Топик Kafka для вычитки сообщений.
- **`min_bytes` и `max_bytes`**: Минимальный и максимальный размер данных для чтения.
- **`message_limit`**: Лимит сообщений для отправки.
- **`post_url`**: URL для отправки сообщений.
- **`port`**: Порт для запуска веб-сервера.

---

## Запуск приложения

Для запуска приложения выполните:

```bash
go run cmd/main.go
```

После запуска приложение будет доступно по адресу: [http://localhost:8080](http://localhost:8080).

---

## Использование

### Веб-интерфейс

Откройте в браузере [http://localhost:8080](http://localhost:8080). Вы увидите страницу с кнопками для управления приложением:

1. **Start Consumer**: Запускает вычитку сообщений из Kafka.
2. **Stop Consumer**: Останавливает вычитку сообщений.
3. **Configuration**: Позволяет редактировать конфигурацию приложения.

### API (опционально)

Вы также можете взаимодействовать с приложением через API:

- **Запуск консьюмера**:
  ```bash
  curl -X POST http://localhost:8080/start
  ```

- **Остановка консьюмера**:
  ```bash
  curl -X POST http://localhost:8080/stop
  ```

- **Получение текущей конфигурации**:
  ```bash
  curl -X GET http://localhost:8080/config
  ```

- **Обновление конфигурации**:
  ```bash
  curl -X POST -H "Content-Type: application/json" -d '{"brokers":["localhost:9092"],"group_id":"my-group","topic":"test-topic","min_bytes":10000,"max_bytes":10000000,"message_limit":10,"post_url":"http://localhost:8080/api/messages","port":8080}' http://localhost:8080/config/update
  ```

---

## Логирование

Приложение использует кастомный логгер, определенный в `pkg/logger/logger.go`, для логирования сообщений на разных уровнях (Info, Error, Debug). Убедитесь, что логирование настроено корректно.

---

## Вклад в проект

Мы приветствуем ваши предложения и улучшения! Вы можете отправить pull request или открыть issue для исправления ошибок или добавления новых функций.

---

## Лицензия

Этот проект распространяется под лицензией MIT. Подробнее см. в файле `LICENSE`.
# Kafka to API Service

Простой сервис на Go, который читает сообщения из указанного топика Kafka, накапливает их в памяти и периодически отправляет пачкой (в виде JSON-массива) на заданный HTTP API эндпоинт.

## Возможности

* Чтение сообщений из топика Kafka.
* Накопление сообщений в памяти до достижения лимита (`message_limit`).
* Отправка накопленных сообщений пачкой (JSON-массив) на указанный HTTP POST эндпоинт (`post_url`).
* Управление состоянием (запуск/остановка потребителя Kafka) через HTTP API.
* Просмотр и обновление конфигурации через HTTP API (некоторые изменения требуют перезапуска потребителя).
* Простой веб-интерфейс для управления.
* Конфигурация через JSON-файл и флаги командной строки.
* Обработка сигналов ОС для корректного завершения работы.

## Структура Проекта

* `cmd/main.go`: Точка входа приложения, настройка HTTP-сервера и обработка сигналов.
* `internal/kafka/`: Логика потребителя Kafka, буферизация и отправка сообщений. Опредение структуры конфигурации.
* `web/`: Статические файлы для веб-интерфейса (HTML, JS, CSS).
* `config.json` (Пример): Файл конфигурации (расположение задается флагом).
* `go.mod`, `go.sum`: Файлы управления зависимостями Go.

*(Были удалены пакеты `internal/config`, `internal/api`, `pkg/logger`)*

## Установка

1.  Клонируйте репозиторий (если еще не сделано):
    ```bash
    git clone <your-repo-url>
    cd <your-repo-directory>
    ```
2.  Загрузите зависимости:
    ```bash
    go mod tidy
    # или
    go mod download
    ```

## Конфигурация

Приложение настраивается с помощью JSON-файла. Путь к файлу указывается при запуске с помощью флага `-config`. По умолчанию используется `./config.json`.

**Пример `config.json`:**

```json
{
  "brokers": ["localhost:9092"],  // Список брокеров Kafka
  "group_id": "kafka-to-api-group", // ID группы потребителей (может быть пустым)
  "topic": "your-kafka-topic",      // Топик Kafka для чтения
  "min_bytes": 1,                  // Минимальный размер батча от Kafka (параметр kafka-go)
  "max_bytes": 1048576,            // Максимальный размер батча от Kafka (1MB, параметр kafka-go)
  "message_limit": 50,             // Кол-во сообщений для накопления перед отправкой
  "post_url": "http://localhost:8000/api/messages", // URL для отправки сообщений
  "send_timeout_seconds": 15       // Таймаут для HTTP-запроса отправки (секунды)
}
